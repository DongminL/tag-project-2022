<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zootopedia</title>
    <script src="https://kit.fontawesome.com/c58241218c.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/mypage.css">
    <script src="/js/mypage.js"></script>
</head>


{{>layouts/header}}

<!------ section ------>
<section id="section">
    <div id="section_name">
        <div></div>
        <h3>마이페이지</h3>
    </div>
    <div class="mypage_movie">
        <i class="fa-regular fa-greater-than"></i>
        <h4>내가 평가한 영화목록</h4>
        <i class="fa-solid fa-pen fa-flip-horizontal"></i>
    </div>
    <div id="mypage_comment">
        <div class="mypage_review">
            <p class="mypage_review_in"><i><b>Spider-Man: No Way Home</b></i></p>
            <p class="mypage_review_in">2022, 누적관객수, 별점</p>
            <hr class="mypage_review_in">
            <p class="mypage_review_in">comment</p>
        </div>
    </div>

    <div class="mypage_movie">
        <i class="fa-regular fa-greater-than"></i>
        <h4>보고싶은 영화</h4>
        <i class="fa-solid fa-folder-closed fa-flip-horizontal"></i>
    </div>
    <div id="mypage_want">
        <div></div>
    </div>

    <div class="mypage_movie">
        <i class="fa-regular fa-greater-than"></i>
        <h4>보는 중 영화</h4>
        <i class="fa-solid fa-ticket"></i>
    </div>
    <div id="mypage_watching">
        <div></div>
    </div>
</section>


<script>
    /** 마이페이지 정보 fetch 호출 함수 */
    function callFetchMypageFirst() {
        fetch('/api/get/rating')
                .then(response => response.json())
                .then(function (json) {
                    console.log(json);
                    for (let i = 0; i < json.length; i++) {
                        let myReview = json[i];

                        // myReview_userId = myReview.userId;
                        // myReview_movieId = myReview.movieId;
                        // myReview_rating = myReview.rating;

                    }
                })
                .catch((err) => {
                    console.log(err);
                })
    }
    callFetchMypageFirst()

    function callFetchMypageSecond() {
        fetch('/api/get/wanting')
                .then(response => response.json())
                .then(function (json) {
                    console.log(json);
                    for (let i = 0; i < json.length; i++) {
                        let myWant = json[i].movie;

                        let myWantMovieNm = myWant.movieNm;
                        let myWantNationAlt = myWant.nationAlt;
                        let myWantOpenDt = myWant.openDt;
                        let myWantImg = myWant.poster;

                        let user_want = document.getElementById('mypage_want');
                        let new_divTag = document.createElement('div');

                        let new_aTag = document.createElement('a');
                        new_aTag.setAttribute('id', 'new_aTag');

                        let new_pTag_wImg = document.createElement('img');
                        let new_pTag_wMovieNm = document.createElement('p');
                        let new_pTag_wNationAlt = document.createElement('p');
                        let new_pTag_wOpenDt = document.createElement('p');

                        new_pTag_wImg.setAttribute('type', 'image');
                        new_pTag_wImg.setAttribute('src', `${myWantImg}`);
                        new_pTag_wMovieNm.setAttribute('id', 'wmovie_title');
                        new_pTag_wNationAlt.setAttribute('id', 'wnation');
                        new_pTag_wOpenDt.setAttribute('id', 'wopen_dt');

                        new_pTag_wMovieNm.append(`${myWantMovieNm}`);
                        new_pTag_wNationAlt.append(`${myWantNationAlt}`);
                        new_pTag_wOpenDt.append(`${myWantOpenDt.substr(0, 4)}`);

                        new_divTag.append(new_pTag_wImg);
                        new_divTag.append(new_pTag_wMovieNm);
                        new_divTag.append(new_pTag_wNationAlt);
                        new_divTag.append(new_pTag_wOpenDt);
                        new_aTag.append(new_divTag);

                        user_want.appendChild(new_aTag);
                    }
                })
                .catch((err) => {
                    console.log(err);
                })
    }
    callFetchMypageSecond();

    function callFetchMypageThird() {
        fetch('/api/get/watching')
                .then(response => response.json())
                .then(function (json) {
                    console.log(json);
                    for (let i = 0; i < json.length; i++) {
                        let myWatch = json[i].movie;

                        let myWatchMovieNm = myWatch.movieNm;
                        let myWatchNationAlt = myWatch.nationAlt;
                        let myWatchOpenDt = myWatch.openDt;
                        let myWatchImg = myWatch.poster;

                        let user_watching = document.getElementById('mypage_watching');
                        let new_divTag = document.createElement('div');

                        let new_aTag = document.createElement('a');
                        new_aTag.setAttribute('id', 'new_aTag');

                        let new_pTag_ingImg = document.createElement('img');
                        let new_pTag_ingMovieNm = document.createElement('p');
                        let new_pTag_ingNationAlt = document.createElement('p');
                        let new_pTag_ingOpenDt = document.createElement('p');

                        new_pTag_ingImg.setAttribute('type', 'image');
                        new_pTag_ingImg.setAttribute('src', `${myWatchImg}`);
                        new_pTag_ingMovieNm.setAttribute('id', 'ingmovie_title');
                        new_pTag_ingNationAlt.setAttribute('id', 'ingnation');
                        new_pTag_ingOpenDt.setAttribute('id', 'ingopen_dt');

                        new_pTag_ingMovieNm.append(`${myWatchMovieNm}`);
                        new_pTag_ingNationAlt.append(`${myWatchNationAlt}`);
                        new_pTag_ingOpenDt.append(`${myWatchOpenDt}`);

                        new_divTag.append(new_pTag_ingImg);
                        new_divTag.append(new_pTag_ingMovieNm);
                        new_divTag.append(new_pTag_ingNationAlt);
                        new_divTag.append(new_pTag_ingOpenDt);
                        new_aTag.append(new_divTag);

                        user_watching.appendChild(new_aTag);
                    }
                })
                .catch((err) => {
                    console.log(err);
                })
    }
    callFetchMypageThird();
</script>

{{>layouts/footer}}